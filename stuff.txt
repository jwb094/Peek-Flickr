 })let map;
let data;
$(() => {


    $("#submitSearch").click((e) => {
        
        e.preventDefault();
        let searchphoto = $('#search').val();
        $.ajax({
            url: `/photo/${searchphoto}`,
            method: 'POST',
            data: {
                photo: $('#search').val()
            }
        })
       
            .then((data) => {
                initMap(data) 
            })
})


      //initialises the google map
    function initMap(data) {
       
        let markers = [];
        var uluru = { lat: 51.643173, lng: 0.050168 };
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 3,
            center: uluru
        });

        let markerData = data.result;

        for (let i in markerData) {
            console.log(markerData[i].latitude);
            var pos = new google.maps.LatLng(markerData[i].latitude, markerData[i].longitude);
            createMarker(pos, markerData[i].title, markerData[i].url_l);
        }
    }

    //passing the photo image URL in this function
    function createMarker(pos, t, url_l) {
        var marker = new google.maps.Marker({
            position: pos,
            map: map,
            title: t
        });

        let contentString = `<img src="${url_l}" />`;

        let infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        google.maps.event.addListener(marker, 'click', function () {
            infowindow.open(map, marker);
        });

        return marker;
    }



 
////
<!DOCTYPE html>
<html>

<head>
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css">
    <link type="text/css" rel="stylesheet" href="css/main.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>Flickr Search</title>
</head>

<body>
    <% include ./partials/navigation %>
        <!-- start of search bar and button -->
        <br>
        <!-- SEARCH FORM-->
        <div class="row">

            <form class="col l6">
                <div class="row">
                    <div class="col s6">
                        <input placeholder="Enter Desired Event Location" name="search" id="search" type="text" class="validate" required>
                    </div>
                    <div class="col s6">
                        <button id="submitSearch" class="btn waves-effect waves-light" type="submit" name="action"> <i class="material-icons">search</i> </button></div>
                </div>
            </form>
        </div>


        <div id="map"></div>




        <footer><b>“When I look at my old pictures, all I can see is what I used to be but am no longer. I think: What I can see is what I am not.”</b>
            <h6>― Aleksandar Hemon, The Lazarus Project</h6>
        </footer>


       
       <script src="js/jquery-3.1.1.min.js"></script>
       <script src="js/materialize.js"></script>
       <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAJ0Xr2B6HTUs5Ji74ml5GL5OiuOENJhnc"  ></script>
       <script src="js/Photo.js"></script>
       <!-- &callback=initMap-->
</body>

</html>

